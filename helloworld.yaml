mixed-port: 7890
allow-lan: true
bind-address: '*'
mode: rule
log-level: info
tcp-concurrent: true
unified-delay: true
external-controller: '127.0.0.1:9090'

dns:
    enabled: true
    listen: '127.0.0.1:3653'
    ipv6: false
    enhanced-mode: redir-host
    nameserver: [8.8.8.8, 8.8.4.4, 1.1.1.1, 208.67.222.222]
    use-hosts: true
    hosts: { mtalk.google.com: [142.251.170.188, 108.177.125.188], alt1-mtalk.google.com: 192.178.164.188, alt2-mtalk.google.com: 192.178.164.188, alt3-mtalk.google.com: 192.178.164.188, alt4-mtalk.google.com: 192.178.164.188, alt5-mtalk.google.com: 192.178.164.188, alt6-mtalk.google.com: 192.178.164.188, alt7-mtalk.google.com: 192.178.164.188, alt8-mtalk.google.com: 192.178.131.188 }

profile:
  store-selected: true
  store-fake-ip: true
  proxy-groups-mode: true

proxies:
 - { name: Test, type: trojan, server: 1.1.1.1, port: 80, password: 892da692-565d-4225-82ef-f913d6ddc360, udp: true, sni: 1.1.1.1 }
    
proxy-providers:


rule-providers:
  AntiAd:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/privacy-protection-tools/anti-AD/master/anti-ad-clash.yaml"
    path: ./ruleset/AntiAd.yaml
    interval: 86400

  banAD:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/refs/heads/master/Clash/Providers/BanAD.yaml"
    path: ./ruleset/BanAD.yaml
    interval: 86400

  adblockmihomo:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/217heidai/adblockfilters/main/rules/adblockmihomo.yaml"
    path: ./ruleset/adblockmihomo.yaml
    interval: 86400

  AD:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/earoftoast/clash-rules/main/AD.yaml"
    path: ./ruleset/AD.yaml
    interval: 86400

  EasyList:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/earoftoast/clash-rules/main/EasyList.yaml"
    path: ./ruleset/EasyList.yaml
    interval: 86400

  EasyListChina:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/earoftoast/clash-rules/main/EasyListChina.yaml"
    path: ./ruleset/EasyListChina.yaml
    interval: 86400

  EasyPrivacy:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/earoftoast/clash-rules/main/EasyPrivacy.yaml"
    path: ./ruleset/EasyPrivacy.yaml
    interval: 86400

  ProgramAD:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/earoftoast/clash-rules/main/ProgramAD.yaml"
    path: ./ruleset/ProgramAD.yaml
    interval: 86400

  adblock_loyal:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"
    path: ./ruleset/adblock_loyal.yaml
    interval: 86400

  AI:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/refs/heads/master/Clash/Providers/Ruleset/AI.yaml"
    path: ./ruleset/AI.yaml
    interval: 86400

proxy-groups:
  - name: 节点选择
    type: select
    proxies:  
      - 自动选择
      - Test
    url: https://www.google.com/generate_204
    timeout: 5000
    filter: ^(?!.*(剩余流量|套餐到期|距离下次|本站|关注|海外|官网|群组)).*$

  - name: 自动选择
    type: url-test
    proxies: [Test]
    interval: 60
    url: https://www.google.com/generate_204
    max-failed-times: 3
    timeout: 5000 
    filter: ^(?!.*(剩余流量|套餐到期|距离下次|本站|关注|海外|官网|群组)).*$

rules:
  - RULE-SET,AD,REJECT
  - RULE-SET,adblockmihomo,REJECT
  - RULE-SET,EasyList,REJECT
  - RULE-SET,EasyListChina,REJECT
  - RULE-SET,EasyPrivacy,REJECT
  - RULE-SET,ProgramAD,REJECT
  - RULE-SET,adblock_loyal,REJECT
  - RULE-SET,banAD,REJECT
  - RULE-SET,AntiAd,REJECT


  # 新增的直连规则
  - DOMAIN-SUFFIX,local,DIRECT
  - IP-CIDR,127.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  - IP-CIDR,192.168.0.0/16,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  - IP-CIDR,17.0.0.0/8,DIRECT
  - IP-CIDR,100.64.0.0/10,DIRECT
  - IP-CIDR,224.0.0.0/4,DIRECT
  - IP-CIDR6,fe80::/10,DIRECT
  - DOMAIN-SUFFIX,cn,DIRECT
  - DOMAIN-KEYWORD,-cn,DIRECT
  - GEOIP,LAN,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,节点选择
